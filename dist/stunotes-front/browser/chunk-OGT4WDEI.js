import{a as z}from"./chunk-XAEKYMNB.js";import{a as Y}from"./chunk-Z47XEYJ7.js";import{a as E}from"./chunk-EKFKDTWY.js";import{a as T,b as u,c as S,d as w,g as R,i as N,j,k as V,l as A,m as D,n as G,q as L,s as q}from"./chunk-POKNL4PY.js";import"./chunk-EV5VSRPK.js";import{d as P,f as I}from"./chunk-AVDHOTCV.js";import{Da as d,Hb as k,Ib as M,Jb as O,Lb as F,Oa as s,Pa as n,Qa as o,Ra as l,U as _,Ua as y,V as C,Va as v,Wa as p,bb as b,cb as a,eb as m,pa as r,ta as f,za as h}from"./chunk-LRXCIMQ7.js";import{e as $}from"./chunk-EQDQRRRY.js";var x=$(Y());function H(i,t){i&1&&(n(0,"div",8),l(1,"div",9),n(2,"p"),a(3,"Cargando tarea..."),o()())}function J(i,t){if(i&1&&(n(0,"div",35),a(1),o()),i&2){let e=p(2);r(),m(" ",e.getFieldError("title")," ")}}function K(i,t){if(i&1&&(n(0,"div",35),a(1),o()),i&2){let e=p(2);r(),m(" ",e.getFieldError("description")," ")}}function Q(i,t){if(i&1&&(n(0,"option",36),a(1),o()),i&2){let e=t.$implicit;s("value",e.id),r(),m(" ",e.name," ")}}function U(i,t){if(i&1&&(n(0,"div",35),a(1),o()),i&2){let e=p(2);r(),m(" ",e.getFieldError("categoryId")," ")}}function W(i,t){if(i&1&&(n(0,"div",37),l(1,"input",38),n(2,"label",39),l(3,"span",40),a(4),o()()),i&2){let e=t.$implicit,c=p(2);r(),s("id","priority-"+e.value)("value",e.value),r(),s("for","priority-"+e.value)("ngClass",c.getPriorityClass(e.value)),r(2),m(" ",e.label," ")}}function X(i,t){if(i&1&&(n(0,"div",35),a(1),o()),i&2){let e=p(2);r(),m(" ",e.getFieldError("priority")," ")}}function Z(i,t){i&1&&l(0,"div",41)}function ee(i,t){i&1&&l(0,"i",42)}function te(i,t){if(i&1){let e=y();n(0,"div",10)(1,"form",11),v("ngSubmit",function(){_(e);let g=p();return C(g.onSubmit())}),n(2,"div",12)(3,"label",13),l(4,"i",14),a(5," T\xEDtulo * "),o(),l(6,"input",15),d(7,J,2,1,"div",16),o(),n(8,"div",12)(9,"label",17),l(10,"i",18),a(11," Descripci\xF3n "),o(),n(12,"textarea",19),a(13,"        "),o(),d(14,K,2,1,"div",16),o(),n(15,"div",12)(16,"label",20),l(17,"i",21),a(18," Categor\xEDa * "),o(),n(19,"select",22)(20,"option",23),a(21,"Selecciona una categor\xEDa"),o(),d(22,Q,2,2,"option",24),o(),d(23,U,2,1,"div",16),o(),n(24,"div",12)(25,"label",25),l(26,"i",26),a(27," Prioridad * "),o(),n(28,"div",27),d(29,W,5,5,"div",28),o(),d(30,X,2,1,"div",16),o(),n(31,"div",29)(32,"button",30),v("click",function(){_(e);let g=p();return C(g.onCancel())}),l(33,"i",31),a(34," Cancelar "),o(),n(35,"button",32),d(36,Z,1,0,"div",33)(37,ee,1,0,"i",34),a(38),o()()()()}if(i&2){let e=p();r(),s("formGroup",e.taskForm),r(5),b("error",e.isFieldInvalid("title")),r(),s("ngIf",e.isFieldInvalid("title")),r(5),b("error",e.isFieldInvalid("description")),r(2),s("ngIf",e.isFieldInvalid("description")),r(5),b("error",e.isFieldInvalid("categoryId")),r(3),s("ngForOf",e.categories),r(),s("ngIf",e.isFieldInvalid("categoryId")),r(6),s("ngForOf",e.priorities),r(),s("ngIf",e.isFieldInvalid("priority")),r(2),s("disabled",e.submitting),r(3),s("disabled",e.taskForm.invalid||e.submitting),r(),s("ngIf",e.submitting),r(),s("ngIf",!e.submitting),r(),m(" ",e.submitting?"Guardando...":e.isEditMode?"Actualizar":"Crear Tarea"," ")}}var B=class i{constructor(t,e,c,g,ie){this.fb=t;this.taskService=e;this.categoryService=c;this.route=g;this.router=ie;this.taskForm=this.createForm()}taskForm;categories=[];isEditMode=!1;taskId=null;loading=!1;submitting=!1;priorities=[{value:1,label:"Alta",color:"high"},{value:2,label:"Media",color:"medium"},{value:3,label:"Baja",color:"low"}];ngOnInit(){this.taskId=this.route.snapshot.params.id?+this.route.snapshot.params.id:null,this.isEditMode=!!this.taskId,this.loadCategories(()=>{this.isEditMode&&this.taskId&&this.loadTask(this.taskId)})}createForm(){return this.fb.group({title:["",[u.required,u.maxLength(100)]],description:[""],priority:[2,u.required],categoryId:["",u.required],userId:[1]})}loadCategories(t){this.categoryService.getCategories().subscribe({next:e=>{this.categories=e,t&&t()},error:e=>{console.error("Error loading categories:",e),this.showError("Error al cargar las categor\xEDas")}})}loadTask(t){this.loading=!0,this.taskService.getTaskById(t).subscribe({next:e=>{this.taskForm.patchValue({title:e.title,description:e.description,priority:e.priority,categoryId:e.category?.id,userId:e.user?.id}),this.loading=!1},error:e=>{console.error("Error loading task:",e),this.showError("Error al cargar la tarea"),this.loading=!1,this.router.navigate(["/tasks"])}})}onSubmit(){if(this.taskForm.invalid){this.markFormGroupTouched(),x.default.fire("Error","Por favor complete todos los campos correctamente.","error");return}if(!this.submitting){this.submitting=!0;let t=this.taskForm.value,e={title:t.title,description:t.description,priority:t.priority,categoryId:t.categoryId,userId:t.userId};this.isEditMode&&this.taskId?this.taskService.updateTask(this.taskId,e).subscribe({next:()=>{this.submitting=!1,x.default.fire("Actualizado","La tarea fue actualizada correctamente.","success"),this.router.navigate(["/tasks"])},error:c=>{console.error("Error updating task:",c),this.submitting=!1,this.showError("Error al actualizar la tarea")}}):this.taskService.createTask(e).subscribe({next:()=>{this.submitting=!1,x.default.fire("Creado","La tarea fue creada correctamente.","success"),this.router.navigate(["/tasks"])},error:c=>{console.error("Error creating task:",c),this.submitting=!1,this.showError("Error al crear la tarea")}})}}onCancel(){this.router.navigate(["/tasks"])}markFormGroupTouched(){Object.keys(this.taskForm.controls).forEach(t=>{this.taskForm.get(t)?.markAsTouched()})}isFieldInvalid(t){let e=this.taskForm.get(t);return!!(e&&e.invalid&&(e.dirty||e.touched))}getFieldError(t){let e=this.taskForm.get(t);if(e?.errors){if(e.errors.required)return`${this.getFieldLabel(t)} es requerido`;if(e.errors.maxlength)return`${this.getFieldLabel(t)} no puede exceder ${e.errors.maxlength.requiredLength} caracteres`}return""}getFieldLabel(t){return{title:"El t\xEDtulo",description:"La descripci\xF3n",priority:"La prioridad",categoryId:"La categor\xEDa"}[t]||t}getPriorityClass(t){switch(t){case 1:return"priority-high";case 2:return"priority-medium";case 3:return"priority-low";default:return"priority-medium"}}showError(t){x.default.fire("Error",t,"error")}static \u0275fac=function(e){return new(e||i)(f(L),f(E),f(z),f(P),f(I))};static \u0275cmp=h({type:i,selectors:[["app-task-form"]],decls:10,vars:3,consts:[[1,"form-container"],[1,"form-header"],[1,"form-title"],[1,"fas","fa-tasks"],["type","button",1,"back-btn",3,"click"],[1,"fas","fa-arrow-left"],["class","loading-container",4,"ngIf"],["class","form-content",4,"ngIf"],[1,"loading-container"],[1,"loading-spinner"],[1,"form-content"],[1,"task-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","title",1,"form-label"],[1,"fas","fa-heading"],["type","text","id","title","formControlName","title","placeholder","Ingresa el t\xEDtulo de la tarea",1,"form-input"],["class","error-message",4,"ngIf"],["for","description",1,"form-label"],[1,"fas","fa-align-left"],["id","description","formControlName","description","placeholder","Describe los detalles de la tarea...","rows","4",1,"form-textarea"],["for","categoryId",1,"form-label"],[1,"fas","fa-folder"],["id","categoryId","formControlName","categoryId",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-label"],[1,"fas","fa-exclamation-triangle"],[1,"priority-options"],["class","priority-option",4,"ngFor","ngForOf"],[1,"form-actions"],["type","button",1,"btn","btn-cancel",3,"click","disabled"],[1,"fas","fa-times"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","btn-spinner",4,"ngIf"],["class","fas fa-save",4,"ngIf"],[1,"error-message"],[3,"value"],[1,"priority-option"],["type","radio","formControlName","priority",1,"priority-radio",3,"id","value"],[1,"priority-label",3,"for","ngClass"],[1,"priority-indicator"],[1,"btn-spinner"],[1,"fas","fa-save"]],template:function(e,c){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),l(3,"i",3),a(4),o(),n(5,"button",4),v("click",function(){return c.onCancel()}),l(6,"i",5),a(7," Volver "),o()(),d(8,H,4,0,"div",6)(9,te,39,18,"div",7),o()),e&2&&(r(4),m(" ",c.isEditMode?"Editar Tarea":"Nueva Tarea"," "),r(4),s("ngIf",c.loading),r(),s("ngIf",!c.loading))},dependencies:[F,k,M,O,q,R,D,G,T,A,N,S,w,j,V],styles:['.form-container[_ngcontent-%COMP%]{max-width:700px;margin:0 auto;padding:20px;background:#f8f9fa;min-height:100vh;font-family:"Font Awesome 6 Brand",sans-serif}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding:20px;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a}.form-title[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#1f2937;margin:0;display:flex;align-items:center;gap:12px}.form-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#7c3aed}.back-btn[_ngcontent-%COMP%]{padding:10px 20px;background:#6c757d;color:#fff;border:none;border-radius:8px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.back-btn[_ngcontent-%COMP%]:hover{background:#5a6268;transform:translateY(-2px)}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px;color:#6b7280}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #f3f4f6;border-top:4px solid #7c3aed;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:16px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.form-content[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.task-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#374151;font-size:14px;display:flex;align-items:center;gap:8px}.form-label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#7c3aed;width:16px}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{padding:12px 16px;border:2px solid #e5e7eb;border-radius:8px;font-size:14px;transition:all .3s ease;background:#fff}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#7c3aed;box-shadow:0 0 0 3px #7c3aed1a}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px;font-family:inherit}.form-select[_ngcontent-%COMP%]{cursor:pointer}.form-input.error[_ngcontent-%COMP%], .form-textarea.error[_ngcontent-%COMP%], .form-select.error[_ngcontent-%COMP%]{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.error-message[_ngcontent-%COMP%]{color:#ef4444;font-size:12px;font-weight:500;margin-top:4px}.priority-options[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap}.priority-option[_ngcontent-%COMP%]{display:flex;align-items:center}.priority-radio[_ngcontent-%COMP%]{display:none}.priority-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 20px;border:2px solid #e5e7eb;border-radius:8px;cursor:pointer;transition:all .3s ease;font-weight:500;-webkit-user-select:none;user-select:none}.priority-label[_ngcontent-%COMP%]:hover{border-color:#d1d5db}.priority-radio[_ngcontent-%COMP%]:checked + .priority-label[_ngcontent-%COMP%]{border-color:currentColor;background:#ffffff1a;transform:scale(1.05)}.priority-indicator[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;background:currentColor}.priority-high[_ngcontent-%COMP%]{color:#dc2626}.priority-medium[_ngcontent-%COMP%]{color:#d97706}.priority-low[_ngcontent-%COMP%]{color:#16a34a}.form-actions[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;margin-top:20px;padding-top:20px;border-top:1px solid #e5e7eb}.btn[_ngcontent-%COMP%]{padding:12px 24px;border:none;border-radius:8px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px;min-width:120px;justify-content:center}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important}.btn-cancel[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6268;transform:translateY(-2px)}.btn-primary[_ngcontent-%COMP%]{background:#7c3aed;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#6d28d9;transform:translateY(-2px)}.btn-spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top:2px solid white;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@media (max-width: 768px){.form-container[_ngcontent-%COMP%]{padding:10px}.form-header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:stretch}.form-title[_ngcontent-%COMP%]{justify-content:center}.form-content[_ngcontent-%COMP%]{padding:20px}.priority-options[_ngcontent-%COMP%]{flex-direction:column}.priority-label[_ngcontent-%COMP%]{justify-content:center}.form-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.btn[_ngcontent-%COMP%]{width:100%}}']})};export{B as TaskFormComponent};
