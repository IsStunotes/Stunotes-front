import{a as j}from"./chunk-5WHMCQS5.js";import{a as V,b as N}from"./chunk-HPU7R7PD.js";import{a as z}from"./chunk-PC7V7UYZ.js";import{a as T}from"./chunk-IPWEQVUB.js";import"./chunk-EV5VSRPK.js";import{f as I,g as L,i as F}from"./chunk-5Q5GY2AE.js";import{Da as x,Kb as R,Lb as S,Oa as p,Ob as E,Pa as i,Pb as D,Qa as a,Ra as u,Sa as h,Ta as y,U as d,V as m,Va as b,Wa as f,Xa as l,eb as s,fb as v,gb as k,hb as O,nb as M,ob as P,pa as c,pb as w,ta as _,za as C}from"./chunk-WFUTHYHP.js";import"./chunk-EQDQRRRY.js";var A=r=>["/document",r,"comments"];function Y(r,o){r&1&&(i(0,"div",3),s(1,"Cargando repositorios..."),a())}function B(r,o){if(r&1&&(i(0,"div",4),s(1),a()),r&2){let e=l();c(),v(e.error)}}function H(r,o){r&1&&(i(0,"div",17),s(1," A\xFAn no se ha creado un repositorio "),a())}function U(r,o){if(r&1){let e=b();i(0,"div",23)(1,"a",24)(2,"div",25)(3,"h3"),s(4),a(),i(5,"p"),s(6),a(),i(7,"small"),s(8),P(9,"date"),a()()(),i(10,"button",20),f("click",function(n){let g=d(e).$implicit,q=l().$implicit;return l(2).eliminarDocumento(g.id,q.id),m(n.stopPropagation())}),s(11," \u{1F5D1}\uFE0F Eliminar "),a()()}if(r&2){let e=o.$implicit;c(),p("routerLink",M(8,A,e.id)),c(3),v(e.title),c(2),v(e.description),c(2),O(" Documento v",e.version," \u2013 ",w(9,5,e.dateCreated,"yyyy-MM-dd")," ")}}function J(r,o){if(r&1){let e=b();h(0),i(1,"h2"),s(2),a(),i(3,"div",18)(4,"button",19),f("click",function(){let n=d(e).$implicit,g=l(2);return m(g.crearDocumento(n.id))}),s(5," + Crear nuevo documento "),a(),i(6,"button",20),f("click",function(){let n=d(e).$implicit,g=l(2);return m(g.eliminarRepositorio(n.id))}),s(7," \u{1F5D1}\uFE0F Eliminar repositorio "),a()(),i(8,"div",21),x(9,U,12,10,"div",22),a(),y()}if(r&2){let e=o.$implicit;c(2),k("Repositorio ",e.id),c(7),p("ngForOf",e.documents)}}function G(r,o){if(r&1){let e=b();i(0,"div")(1,"div",5)(2,"div",6)(3,"button",7),f("click",function(){d(e);let n=l();return m(n.cancelar())}),u(4,"i",8),s(5," Atr\xE1s "),a(),i(6,"button",9),f("click",function(){d(e);let n=l();return m(n.crearRepositorio())}),u(7,"i",10),s(8," Nuevo Repositorio "),a()(),i(9,"div",11)(10,"div",12),u(11,"input",13),i(12,"span",14),s(13,"\u{1F50D}"),a()()()(),x(14,H,2,0,"div",15)(15,J,10,2,"ng-container",16),u(16,"app-footer"),a()}if(r&2){let e=l();c(14),p("ngIf",e.repositories.length===0&&!e.loading),c(),p("ngForOf",e.repositories)}}var $=class r{constructor(o,e,t){this.repositoryService=o;this.documentService=e;this.router=t}repositories=[];loading=!1;error="";ngOnInit(){this.loadRepositories()}loadRepositories(){this.loading=!0;let o=localStorage.getItem("user");if(!o){this.error="No hay usuario autenticado.",this.loading=!1;return}let e=JSON.parse(o);e.role==="TEACHER"||e.roleId===2?this.repositoryService.getAllRepositories().subscribe({next:t=>{this.repositories=t,this.loading=!1},error:t=>{console.error("Error al obtener todos los repositorios:",t),this.error="Error al cargar todos los repositorios",this.loading=!1}}):this.repositoryService.getRepositoriesByUsuarioId(e.id).subscribe({next:t=>{this.repositories=t,this.loading=!1},error:t=>{console.error("Error al obtener repositorios del usuario:",t),this.error="Error al cargar repositorios del usuario",this.loading=!1}})}crearDocumento(o){this.router.navigate(["/document/create"],{queryParams:{repositoryId:o}})}cancelar(){history.back()}crearRepositorio(){let o=localStorage.getItem("user");if(!o){alert("No hay usuario autenticado.");return}let t={userId:JSON.parse(o).id};console.log("Payload enviado al backend:",t),this.repositoryService.saveRepository(t).subscribe({next:n=>{this.repositories.push(n)},error:n=>{console.error("Error al crear repositorio:",n),alert("Error al crear repositorio")}})}eliminarRepositorio(o){confirm("\xBFEst\xE1s seguro de que quieres eliminar este repositorio?")&&this.repositoryService.deleteRepository(o).subscribe({next:()=>{this.repositories=this.repositories.filter(e=>e.id!==o)},error:e=>{console.error("Error al eliminar repositorio:",e),alert("No se pudo eliminar el repositorio")}})}eliminarDocumento(o,e){confirm("\xBFDeseas eliminar este documento?")&&this.documentService.deleteDocument(o).subscribe({next:()=>{let t=this.repositories.find(n=>n.id===e);t&&(t.documents=t.documents.filter(n=>n.id!==o))},error:t=>{console.error("Error al eliminar documento:",t),alert("No se pudo eliminar el documento")}})}static \u0275fac=function(e){return new(e||r)(_(j),_(z),_(I))};static \u0275cmp=C({type:r,selectors:[["app-repository-list"]],decls:5,vars:3,consts:[["class","loading",4,"ngIf"],["class","error",4,"ngIf"],[4,"ngIf"],[1,"loading"],[1,"error"],[1,"task-header"],[1,"header-left"],[1,"back-btn",3,"click"],[1,"fas","fa-arrow-left"],[1,"new-task-btn",3,"click"],[1,"fas","fa-plus"],[1,"search-filters"],[1,"search-container"],["type","text","placeholder","Buscar..."],[1,"search-icon"],["class","no-repos-msg",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"no-repos-msg"],[1,"repo-actions"],[1,"create-btn",3,"click"],[1,"delete-btn",3,"click"],[1,"document-grid"],["class","document-card-wrapper",4,"ngFor","ngForOf"],[1,"document-card-wrapper"],[1,"card-link",3,"routerLink"],[1,"card"]],template:function(e,t){e&1&&(u(0,"app-navbar")(1,"app-sidebar"),x(2,Y,2,0,"div",0)(3,B,2,1,"div",1)(4,G,17,2,"div",2)),e&2&&(c(2),p("ngIf",t.loading),c(),p("ngIf",t.error),c(),p("ngIf",!t.loading))},dependencies:[D,R,S,E,F,L,V,T,N],styles:["[_nghost-%COMP%]{font-family:Poppins,sans-serif;background:#fdfdfd;display:block}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{text-align:center;margin-top:20px;font-weight:700}h2[_ngcontent-%COMP%]{margin-top:3rem;margin-bottom:1rem;color:#5f03ff;font-size:1.3rem;font-weight:600;padding:0 2rem}.no-repos-msg[_ngcontent-%COMP%]{text-align:center;font-size:1rem;color:#6b7280;margin:2rem 0;font-style:italic;min-height:600px}.document-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:24px;margin-bottom:4rem;align-items:flex-start;justify-content:flex-start;min-height:500px;padding:0 2rem}.card[_ngcontent-%COMP%]{width:220px;padding:1rem;border:1px solid #ddd;border-radius:12px;background-color:#fff;box-shadow:0 2px 5px #0000000d;display:flex;flex-direction:column;justify-content:space-between}.card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:.5rem;color:#333}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:#555;margin-bottom:.5rem;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:10;line-clamp:10;-webkit-box-orient:vertical}.card[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.75rem;color:#888}.upload-placeholder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:220px;height:160px;border:2px dashed #ccc;border-radius:12px;background-color:#f8f8f8;transition:background-color .3s}.upload-placeholder[_ngcontent-%COMP%]:hover{background-color:#f0f0ff}.upload-btn[_ngcontent-%COMP%]{background-color:#eaeaff;border:none;border-radius:50%;font-size:28px;padding:16px;cursor:pointer;transition:background-color .3s,transform .2s}.upload-btn[_ngcontent-%COMP%]:hover{background-color:#d4d4ff;transform:scale(1.1)}.top-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background-color:#f4f1ff;padding:.75rem 2rem;border-bottom:1px solid #ddd;position:sticky;top:0;z-index:10}.task-header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;padding:20px;gap:1rem;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a}.header-left[_ngcontent-%COMP%]{display:flex;gap:15px}.back-btn[_ngcontent-%COMP%], .new-task-btn[_ngcontent-%COMP%], .create-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]{padding:10px 16px;border:none;border-radius:8px;font-weight:500;font-size:.9rem;cursor:pointer;display:flex;align-items:center;gap:8px;transition:background-color .3s,transform .2s}.back-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.back-btn[_ngcontent-%COMP%]:hover{background:#5a6268;transform:translateY(-2px)}.new-task-btn[_ngcontent-%COMP%]{background:#7c3aed;color:#fff}.new-task-btn[_ngcontent-%COMP%]:hover{background-color:#654de0}.create-btn[_ngcontent-%COMP%]{background-color:#7c3aed;color:#fff}.create-btn[_ngcontent-%COMP%]:hover{background-color:#654de0;transform:translateY(-2px)}.delete-btn[_ngcontent-%COMP%]{background-color:#ef4444;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#dc2626;transform:translateY(-2px)}.search-container[_ngcontent-%COMP%]{position:relative;flex:1 1 250px;max-width:300px;margin-left:auto}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:6px 2rem 6px 8px;border-radius:6px;border:1px solid #ccc;box-sizing:border-box}.search-icon[_ngcontent-%COMP%]{position:absolute;right:8px;top:50%;transform:translateY(-50%);font-size:1rem;color:#888}.repo-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:1rem;flex-wrap:wrap;padding:0 2rem}.document-card-wrapper[_ngcontent-%COMP%]{position:relative}.card-link[_ngcontent-%COMP%]{text-decoration:none}@media screen and (max-width: 768px){.task-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.search-container[_ngcontent-%COMP%]{width:100%;margin-left:0;margin-top:1rem}.repo-actions[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.document-grid[_ngcontent-%COMP%]{justify-content:center}}"]})};export{$ as RepositoryListComponent};
