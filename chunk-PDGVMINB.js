import{a as V,c as T,d as z,e as F,f as j,g as D,p as A,r as H}from"./chunk-HZNXWY7S.js";import{a as h}from"./chunk-EV5VSRPK.js";import{Da as u,Hb as k,Ib as w,Jb as I,K as _,Lb as E,O as x,Oa as p,Pa as i,Qa as o,Tb as N,U as d,Ua as y,V as g,Va as m,Wa as l,cb as a,eb as M,gb as O,hb as P,ib as S,pa as c,ta as b,za as v}from"./chunk-QV3KOCKX.js";var f=class e{constructor(n){this.http=n}apiUrl=`${h.apiUrl}/chat`;sendMessage(n){let t=localStorage.getItem("token"),s=`${n}. Responde en m\xE1ximo 20 palabras.`;return this.http.post(`${h.apiUrl}/chat`,{message:s},{headers:{Authorization:`Bearer ${t}`},responseType:"text"})}static \u0275fac=function(t){return new(t||e)(x(N))};static \u0275prov=_({token:e,factory:e.\u0275fac,providedIn:"root"})};function q(e,n){if(e&1&&(i(0,"div",11),a(1),o()),e&2){let t=n.$implicit;p("ngClass",t.role),c(),M(" ",t.content," ")}}function B(e,n){e&1&&(i(0,"div",12)(1,"span"),a(2,"."),o(),i(3,"span"),a(4,"."),o(),i(5,"span"),a(6,"."),o()())}function R(e,n){if(e&1){let t=y();i(0,"div",2)(1,"div",3),a(2," Asistente Virtual "),i(3,"button",4),m("click",function(){d(t);let r=l();return g(r.toggleChat())}),a(4,"\u2716"),o()(),i(5,"div",5),u(6,q,2,2,"div",6)(7,B,7,0,"div",7),o(),i(8,"form",8),m("ngSubmit",function(){d(t);let r=l();return g(r.send())}),i(9,"input",9),S("ngModelChange",function(r){d(t);let C=l();return P(C.input,r)||(C.input=r),g(r)}),o(),i(10,"button",10),a(11,"\u27A4"),o()()()}if(e&2){let t=l();c(6),p("ngForOf",t.messages),c(),p("ngIf",t.loading),c(2),O("ngModel",t.input),p("disabled",t.loading),c(),p("disabled",t.loading||!t.input.trim())}}var U=class e{constructor(n){this.chatService=n}input="";messages=[];isOpen=!1;loading=!1;toggleChat(){this.isOpen=!this.isOpen}send(){let n=this.input.trim();n&&(this.messages.push({role:"user",content:n}),this.input="",this.loading=!0,this.chatService.sendMessage(n).subscribe({next:t=>{this.messages.push({role:"assistant",content:t}),this.loading=!1},error:t=>{this.messages.push({role:"assistant",content:"\u26A0\uFE0F Error al responder."}),console.error(t),this.loading=!1}}))}static \u0275fac=function(t){return new(t||e)(b(f))};static \u0275cmp=v({type:e,selectors:[["app-floating-chat"]],decls:3,vars:1,consts:[[1,"chat-toggle-btn",3,"click"],["class","chat-container",4,"ngIf"],[1,"chat-container"],[1,"chat-header"],[1,"close-btn",3,"click"],[1,"chat-messages"],[3,"ngClass",4,"ngFor","ngForOf"],["class","assistant typing",4,"ngIf"],["autocomplete","off",1,"chat-input",3,"ngSubmit"],["name","message","placeholder","Escribe tu mensaje...","required","",3,"ngModelChange","ngModel","disabled"],["type","submit",3,"disabled"],[3,"ngClass"],[1,"assistant","typing"]],template:function(t,s){t&1&&(i(0,"div",0),m("click",function(){return s.toggleChat()}),a(1," \u{1F4AC} "),o(),u(2,R,12,5,"div",1)),t&2&&(c(2),p("ngIf",s.isOpen))},dependencies:[E,k,w,I,H,D,V,T,z,A,j,F],styles:["[_nghost-%COMP%]{font-family:Poppins,sans-serif}.chat-toggle-btn[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;background:#7e3af2;color:#fff;border-radius:50%;width:56px;height:56px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:24px;box-shadow:0 4px 10px #0003;z-index:999;transition:background .3s}.chat-toggle-btn[_ngcontent-%COMP%]:hover{background:#5b27c1}.chat-container[_ngcontent-%COMP%]{position:fixed;bottom:90px;right:20px;width:320px;background:#fff;border-radius:10px;box-shadow:0 6px 15px #00000040;display:flex;flex-direction:column;overflow:hidden;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.chat-header[_ngcontent-%COMP%]{background:#7e3af2;color:#fff;padding:12px 16px;font-weight:700;display:flex;justify-content:space-between;align-items:center}.close-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;font-size:18px;cursor:pointer}.chat-messages[_ngcontent-%COMP%]{padding:12px;max-height:300px;overflow-y:auto;font-size:14px;background:#f9f9f9}.chat-messages[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{text-align:right;margin:6px 0;color:#7e3af2}.chat-messages[_ngcontent-%COMP%]   .assistant[_ngcontent-%COMP%]{text-align:left;margin:6px 0;color:#333}.chat-input[_ngcontent-%COMP%]{display:flex;border-top:1px solid #ddd;padding:8px;background:#fff}.chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;font-size:14px;padding:8px;outline:none}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#7e3af2;color:#fff;border:none;padding:0 14px;cursor:pointer;font-size:16px;border-radius:4px}.typing[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blink 1s infinite;margin-right:2px}.typing[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.typing[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){animation-delay:.4s}@keyframes _ngcontent-%COMP%_blink{0%,80%,to{opacity:0}40%{opacity:1}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}"]})};export{U as a};
